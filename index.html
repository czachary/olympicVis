<!DOCTYPE html>
<head>
    <meta charset="utf-8">
    <title>TeamUSA</title>
    <script src="d3/d3.v3.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/topojson/1.6.9/topojson.min.js"></script>
    <script src="datamaps.world.min.js"></script>
</head>
<body onload="init()">
    <div id="top_panel">
      <span>
        <h1 class="title">Modern Summer Olympic Games</h1>
        <h3 class="subtitle" style="display:inline-block">1896-2008</h3> <!-- TODO: show selected year/host country -->
      </span>
      <span class="timeline">
        <div id="slider"></div>
      </span>
    </div>

    <div class="spacer">
      &nbsp;
    </div>

    <div class="stackedTitle">Total Medal Count by Country</div>

    <div class="scroll-on-left">
      <div id="stackedBar_container"></div>
    </div>


    <div id="map_container"></div>
    <div id="linegraph_container"></div>
    <div id="sportsFilter"></div> <!-- TODO: top right under slider, above map? -->


    <script src="map.js"></script>
    <script src="vis.js"></script>
    <link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
    <script src="https://code.jquery.com/jquery-1.12.4.js"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>

    <script>
    $( function() {
      $( "#slider" ).slider({
          value: 1896,
          min: 1896,
          max: 2008,
          step: 4,
          animate: "fast",
          change: function(event, ui) {
            sliderChange(ui.value);
          },
          slide: function(event, ui) {
            var badValues = [1916, 1940, 1944];
            var delta = ui.value - $(this).slider("value");
            for (var i = 0; i < badValues.length; i++) {
              if (ui.value == badValues[i]) {
                var newVal = ui.value;
                while ($.inArray(newVal, badValues) != -1) {
                  newVal += 4 * (delta > 0 ? 1 : -1);
                }
                $(this).slider("value", newVal);
                return false;
              }
            }
          }
        })
        .each(function() {
          var opt = $(this).data().uiSlider.options;
          var vals = opt.max - opt.min;

          // Position the labels
          for (var i = 0; i <= vals; i+=8) {
              var el = $('<label>' + (i + opt.min) + '</label>').css('left', (i/vals*100) + '%');
              $("#slider").append(el);
          }

        });
      });
    </script>
</body>

<style>

  body {
    margin: 20px;
  }

	text {
    font-family: Tahoma;
		font-size: 11px;
	}

  #top_panel {
    position: fixed;
    width: 95%;
    padding: 0 0 20px 20px;
    top: 0;
    left: 0;
    z-index: 1;
    background-color: #FFFFFF;
  }

  .spacer {
    width: 100%;
    height: 85px;
  }

  #slider label {
    position: absolute;
    width: 20px;
    margin-top: 20px;
    margin-left: -10px;
    text-align: center;
  }

  .timeline * {
    font-size: 10px;
    margin-bottom: 10px;
  }

  .tooltip {
    background: #000;
    color: #fff;
    border-radius: 3px;
    position: absolute;
    padding: 5px;
    pointer-events: none;
    text-align: left;
    opacity: .25;
  }

  .medalcounts {
    stroke: black;
    stroke-width: 0;
  }

  #map_container {
    position: fixed;
    top: 130px;
    right: 20px;
  }

  .datamaps-subunits {
    cursor: pointer;
  }

  .clickable {
    cursor: pointer;
  }

  #linegraph_container path { 
    stroke: black;
    stroke-width: 2;
    fill: none;
  }
  .line {
    transform: translateX(13px);
  }


  #stackedBar_container {
    position: relative;
    width: 100%;
    height: 250px;
    direction: ltr;
  }
  .scroll-on-left {
      overflow-x: auto;
      direction: rtl;
  }


  .stackedTitle {
    display: inline-block;
    font-family: Tahoma;
    padding-left: 50px;
  }
  .title {
    font-size: x-large;
    display: inline-block;
    font-family: Tahoma;
  }
  .subtitle {
    font-family: Tahoma;
    float: right;
  }

</style>
